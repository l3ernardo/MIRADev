<textarea name="textarea" id="KC2Test1DataExport" cols="100" style="display:none">{{valuesToString exportKC2Test1}}</textarea>
<textarea name="textarea" id="KC2Test2DataExport" cols="100" style="display:none">{{valuesToString exportKC2Test2}}</textarea>
<textarea name="textarea" id="KC2Test3DataExport" cols="100" style="display:none">{{valuesToString exportKC2Test3}}</textarea>
<table id="kctest_table" class="ibm-data-table" width="100%">
	<tr class="kc-test-content">
		<td class="kc-test-cell" colspan="4">
			<table width="100%" class="ibm-data-table">
				<thead class="kc-test-viewheader">
					<th class="kc-test-viewheader"></th>
					<th colspan="10" class="kc-test-viewheader">Defect Rates &amp; Testing Ratios (%) for Prior and Current Quarters</th>
					<th class="kc-test-viewheader"></th>
					<th colspan="12" class="kc-test-viewheader"># Unremed. Defects @ QE for Prior and Current Quarters</th>
				</thead>
				<thead class="kc-test-viewheader">
					<th class="kc-test-viewheader"></th>
					{{#each PrevQtrs}}
						<th colspan="2" class="kc-test-viewsubheader">{{this}}</th>
					{{/each}}
					<th colspan="2" class="asmt-viewdata-centered">{{CurrentPeriod}}</th>
					<th class="kc-test-viewheader"></th>
					{{#each PrevQtrs}}
						<th colspan="2" class="kc-test-viewsubheader">{{this}}</th>
					{{/each}}
					<th colspan="4" class="asmt-viewdata-centered">{{CurrentPeriod}}</th>
				</thead>
				<tr class="kc-test-viewheader">
					<td class="kc-test-viewheader" width="10%">Process</td>
					<td class="kc-test-viewsubheader" width="4%">DR</td>
					<td class="kc-test-viewsubheader" width="4%">TR</td>
					<td class="kc-test-viewsubheader" width="4%">DR</td>
					<td class="kc-test-viewsubheader" width="4%">TR</td>
					<td class="kc-test-viewsubheader" width="4%">DR</td>
					<td class="kc-test-viewsubheader" width="4%">TR</td>
					<td class="kc-test-viewsubheader" width="4%">DR</td>
					<td class="kc-test-viewsubheader" width="4%">TR</td>
					<td class="kc-test-viewsubheader" width="4%">DR</td>
					<td class="kc-test-viewsubheader" width="4%">TR</td>
					<td class="kc-test-viewheader" width="2%"></td>
					<td class="kc-test-viewsubheader" width="4%">PQ</td>
					<td class="kc-test-viewsubheader" width="4%">CQ</td>
					<td class="kc-test-viewsubheader" width="4%">PQ</td>
					<td class="kc-test-viewsubheader" width="4%">CQ</td>
					<td class="kc-test-viewsubheader" width="4%">PQ</td>
					<td class="kc-test-viewsubheader" width="4%">CQ</td>
					<td class="kc-test-viewsubheader" width="4%">PQ</td>
					<td class="kc-test-viewsubheader" width="4%">CQ</td>
					<td class="kc-test-viewsubheader" width="4%">PQF</td>
					<td class="kc-test-viewsubheader" width="4%">PQO</td>
					<td class="kc-test-viewsubheader" width="4%">CQF</td>
					<td class="kc-test-viewsubheader" width="4%">CQO</td>
				</tr>
				<tr class="asmt-viewdata">
					<td>{{GlobalProcess}}</td>
					{{{defectRateDisplayView DR1FCurrQ_4 parameters.MargThresholdPercent.0.options.0.name parameters.UnsatThresholdPercent.0.options.0.name}}}
					{{{TestingRatioDisplay TR1FCurrQ_4 parameters.MargThresholdPercentTR.0.options.0.name parameters.UnsatThresholdPercentTR.0.options.0.name}}}
					{{{defectRateDisplayView DR1FCurrQ_3 parameters.MargThresholdPercent.0.options.0.name parameters.UnsatThresholdPercent.0.options.0.name}}}
					{{{TestingRatioDisplay TR1FCurrQ_3 parameters.MargThresholdPercentTR.0.options.0.name parameters.UnsatThresholdPercentTR.0.options.0.name}}}
					{{{defectRateDisplayView DR1FCurrQ_2 parameters.MargThresholdPercent.0.options.0.name parameters.UnsatThresholdPercent.0.options.0.name}}}
					{{{TestingRatioDisplay TR1FCurrQ_2 parameters.MargThresholdPercentTR.0.options.0.name parameters.UnsatThresholdPercentTR.0.options.0.name}}}
					{{{defectRateDisplayView DR1FCurrQ_1 parameters.MargThresholdPercent.0.options.0.name parameters.UnsatThresholdPercent.0.options.0.name}}}
					{{{TestingRatioDisplay TR1FCurrQ_1 parameters.MargThresholdPercentTR.0.options.0.name parameters.UnsatThresholdPercentTR.0.options.0.name}}}
					{{{defectRateDisplayView AUDefectRate parameters.MargThresholdPercent.0.options.0.name parameters.UnsatThresholdPercent.0.options.0.name}}}
					{{{TestingRatioDisplay AUTestingRatio parameters.MargThresholdPercentTR.0.options.0.name parameters.UnsatThresholdPercentTR.0.options.0.name}}}
					<td></td>
					{{{UnremedDefectDisplay PQ1FCurrQ_4}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_4}}}
					{{{UnremedDefectDisplay PQ1FCurrQ_3}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_3}}}
					{{{UnremedDefectDisplay PQ1FCurrQ_2}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_2}}}
					{{{UnremedDefectDisplay PQ1FCurrQ_1}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_1}}}
					{{{UnremedDefectDisplay PQ1FCurrQ_F}}}
					{{{UnremedDefectDisplay PQ1FCurrQ_O}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_F}}}
					{{{UnremedDefectDisplay CQ1FCurrQ_O}}}
				</tr>
			</table>
			{{#if editmode}}
				<table width="100%" class="ibm-data-table">
					<tr class="kc-test-cell">
						<td class="kc-test-cell" width="60%">
							<table width="100%" class="ibm-data-table">
								<tr class="kc-test-cell">
									<td class="kc-test-viewsubheader-al" width="80%">Total Country Processes with Defect Rate &ge; 2% / 4%</td>
									<td class="marg-bg" width="10%"></td>
									<td class="unsat-bg" width="10%"></td>
								</tr>
								<tr><td class="kc-test-cell" colspan="3"></td></tr>
								<tr>
									<td class="kc-test-viewheader-al" colspan="3"><b>Explanations for current quarter entries</b></td>
								</tr>
								<tr>
									<td class="asmt-viewdata" colspan="3"><input type="text" name="SOXProcessTestingExplanations" id="SOXProcessTestingExplanations" value="{{SOXProcessTestingExplanations}}" size="100"></td>
								</tr>
								<tr>
									<td class="kc-test-cell" colspan="3">
										<span class="mira-subdata2"><b>Back-up information (if needed)</b> attach updated material from Global Scorecard Pre-review (respective information on additional deficiencies in the same format)</span>
									</td>
								</tr>
							</table>
						</td>
						<td class="kc-test-cell" width="10%"></td>
						<td class="kc-test-cell" width="30%">
							<table width="100%" class="ibm-data-table">
								<tr class="asmt-viewdata">
									<td colspan="4"><b>Key:</b></td>
								</tr>
								<tr class="asmt-viewdata">
									<td colspan="2"><span class="mira-subdata2"><u>DR: Defect Rate</u></span></td>
									<td colspan="2"><span class="mira-subdata2"><u>TR: Testing Ratio</u></span></td>
								</tr>
								<tr class="asmt-viewdata">
									<td width="10%">
										{{{ratingBGDisplay "Sat" ""}}}<br />
										{{{ratingBGDisplay "Marg" ""}}}<br />
										{{{ratingBGDisplay "Unsat" ""}}}<br />
										"-"
									</td>
									<td width="40%">
										<span class="mira-subdata2">
											DR &lt; 2%<br />
											2% &le;  DR &lt; 4%<br />
											DR &ge; 4%<br />
											Not Applicable
										</span>
									</td>
									<td width="10%">
										{{{ratingBGDisplay "Sat" ""}}}<br />
										{{{ratingBGDisplay "Marg" ""}}}<br />
										{{{ratingBGDisplay "Unsat" ""}}}<br />
										"-"
									</td>
									<td width="40%">
										<span class="mira-subdata2">
											TR &ge; 98%<br />
											95% &le; TR &lt; 98%<br />
											TR &lt; 95%<br />
											Not Applicable
										</span>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr class="kc-test-cell">
						<th class="kc-test-label" colspan="4">Focus items, key changes, open items, comments for current &amp; next quarter</th>
					</tr>
					<tr class="kc-test-cell">
						<td class="asmt-viewdata" colspan="4">
							<input type="text" name="ProcessTestingFocusItems" id="ProcessTestingFocusItems" value="{{ProcessTestingFocusItems}}" size="165">
						</td>
					</tr>
				</table>
			{{else}} <!-- Read Mode -->
				<table width="100%" class="ibm-data-table">
					<tr class="kc-test-cell">
						<td class="kc-test-cell" width="60%">
							<table width="100%" class="ibm-data-table">
								<tr class="kc-test-cell">
									<td class="kc-test-viewsubheader-al" width="80%">Total Country Processes with Defect Rate &ge; 2% / 4%</td>
									<td class="marg-bg" width="10%"></td>
									<td class="unsat-bg" width="10%"></td>
								</tr>
								<tr><td class="kc-test-cell" colspan="3"></td></tr>
								<tr>
									<td class="kc-test-viewheader-al" colspan="3"><b>Explanations for current quarter entries</b></td>
								</tr>
								<tr>
									<td class="asmt-viewdata" colspan="3">&nbsp;{{SOXProcessTestingExplanations}}</td>
								</tr>
								<tr>
									<td class="kc-test-cell" colspan="3">
										<span class="mira-subdata2"><b>Back-up information (if needed)</b> attach updated material from Global Scorecard Pre-review (respective information on additional deficiencies in the same format)</span>
									</td>
								</tr>
							</table>
						</td>
						<td class="kc-test-cell" width="10%"></td>
						<td class="kc-test-cell" width="30%">
							<table width="100%" class="ibm-data-table">
								<tr class="asmt-viewdata">
									<td colspan="4"><b>Key:</b></td>
								</tr>
								<tr class="asmt-viewdata">
									<td colspan="2"><span class="mira-subdata2"><u>DR: Defect Rate</u></span></td>
									<td colspan="2"><span class="mira-subdata2"><u>TR: Testing Ratio</u></span></td>
								</tr>
								<tr class="asmt-viewdata">
									<td width="10%">
										{{{ratingBGDisplay "Sat" ""}}}<br />
										{{{ratingBGDisplay "Marg" ""}}}<br />
										{{{ratingBGDisplay "Unsat" ""}}}<br />
										"-"
									</td>
									<td width="40%">
										<span class="mira-subdata2">
											DR &lt; 2%<br />
											2% &le;  DR &lt; 4%<br />
											DR &ge; 4%<br />
											Not Applicable
										</span>
									</td>
									<td width="10%">
										{{{ratingBGDisplay "Sat" ""}}}<br />
										{{{ratingBGDisplay "Marg" ""}}}<br />
										{{{ratingBGDisplay "Unsat" ""}}}<br />
										"-"
									</td>
									<td width="40%">
										<span class="mira-subdata2">
											TR &ge; 98%<br />
											95% &le; TR &lt; 98%<br />
											TR &lt; 95%<br />
											Not Applicable
										</span>
									</td>
								</tr>
							</table>
						</td>
					</tr>
					<tr class="kc-test-cell">
						<th class="kc-test-label" colspan="4">Focus items, key changes, open items, comments for current &amp; next quarter</th>
					</tr>
					<tr class="kc-test-cell">
						<td class="asmt-viewdata" colspan="4">&nbsp;{{ProcessTestingFocusItems}}</td>
					</tr>
				</table>
			{{/if}}
		</td>
	</tr>
	<tr class="kc-test-content">
		<td colspan="4">
			<span class="kc-test-header"><b>Current Quarter Defect Rate Exceptions</b></span><br /><br />
			<a href="javascript:void(0);" value="Export to Excel" name="KC2Test1-link-export" id="KC2Test1-link-export" class="ibm-symp-spreadsheet whiteanchor">Export to Excel</a>
			<span class="ibm-sep">&nbsp;</span>
			<a href="javascript:void(0);" value="Export to Open Office" name="KC2Test1-link-export2" id="KC2Test1-link-export2" class="ibm-symp-spreadsheet whiteanchor">Export to Open Office</a>
			<br /><br />
				<table id="KCT1_treeview" width="100%" class="table_with_scroll">
				<thead>
					<th class="kc-test-viewheader" scope="col" width="40%">Country</th>
					<th class="kc-test-viewheader" scope="col" width="15%"># Tests</th>
					<th class="kc-test-viewheader" scope="col" width="15%"># Defects</th>
					<th class="kc-test-viewheader" scope="col" width="20%">DR %</th>
				</thead>
				{{#each KC2Test1Data}}
					<tr data-tt-id={{id}} data-tt-parent-id="{{parent}}" class="asmt-viewdata">
						<td width="40%"><a target="_blank" href="/assessment?id={{_id}}">{{Country}}</a></td>
						<td width="15%" >{{#if _id}}{{AUTestCount}}{{else}}&nbsp;{{/if}}</td>
						<td width="15%" >{{AUDefectCount}}</td>
						{{{defectRateDisplayView AUDefectRate ../parameters.MargThresholdPercent.0.options.0.name ../parameters.UnsatThresholdPercent.0.options.0.name 20}}}
					</tr>
				{{/each}}
			</table>
		</td>
	</tr>
	<tr class="kc-test-content">
		<td colspan="4">
			<span class="kc-test-header"><b>Current Quarter Testing Ratio Exceptions</b></span><br /><br />
			<a href="javascript:void(0);" value="Export to Excel" name="KC2Test2-link-export" id="KC2Test2-link-export" class="ibm-symp-spreadsheet whiteanchor">Export to Excel</a>
			<span class="ibm-sep">&nbsp;</span>
			<a href="javascript:void(0);" value="Export to Open Office" name="KC2Test2-link-export2" id="KC2Test2-link-export2" class="ibm-symp-spreadsheet whiteanchor">Export to Open Office</a>
			<br /><br />
			<table id="KCT2_treeview" width="100%" class="table_with_scroll">
				<thead>
					<th class="kc-test-viewheader" scope="col" width="5%"></th>
					<th class="kc-test-viewheader" scope="col" width="10%"></th>
					<th class="kc-test-viewheader" scope="col" width="10%"></th>
					<th class="kc-test-viewheader" scope="col" width="20%">Control</th>
					<th class="kc-test-viewheader" scope="col" width="5%">Req'd Samples</th>
					<th class="kc-test-viewheader" scope="col" width="5%">Samples Tested</th>
					<th class="kc-test-viewheader" scope="col" width="5%">TR %</th>
					<th class="kc-test-viewheader" scope="col" width="20%">Reason Under Tested</th>
					<th class="kc-test-viewheader" scope="col" width="25%">Action plan to meet full year req'd samples</th>
				</thead>
				{{#each TRExceptionControls}}
					<tr data-tt-id={{id}} data-tt-parent-id="{{parent}}" class="asmt-viewdata">
						<td width="5%">{{controlCat}}</td>
						<td width="10%">{{{processCat}}}</td>
						<td width="10%">{{controlName}}</td>
						<td width="20%"><a target="_blank" href="/asmtcomponents?id={{_id}}&pid={{../parentid}}">{{controlName}}</a></td>
						<td width="5%">{{numRequiredTests}}</td>
						<td width="5%">{{numActualTests}}</td>
						{{{TestingRatioDisplay testingRatio ../parameters.MargThresholdPercentTR.0.options.0.name ../parameters.UnsatThresholdPercentTR.0.options.0.name 5}}}
						<td width="20%">{{reasonTested}}</td>
						<td width="25%">{{actionPlan}}</td>
					</tr>
				{{/each}}
			</table>
		</td>
	</tr>
	<tr class="kc-test-content">
		<td colspan="4">
			<a href="javascript:void(0);" value="Export to Excel" name="KC2Test3-link-export" id="KC2Test3-link-export" class="ibm-symp-spreadsheet whiteanchor">Export to Excel</a>
			<span class="ibm-sep">&nbsp;</span>
			<a href="javascript:void(0);" value="Export to Open Office" name="KC2Test3-link-export2" id="KC2Test3-link-export2" class="ibm-symp-spreadsheet whiteanchor">Export to Open Office</a>
			<br /><br />
			<table id="KCT3_treeview" width="100%" class="table_with_scroll">
				<thead>
					<th class="kc-test-viewheader" scope="col" width="5%"></th>
					<th class="kc-test-viewheader" scope="col" width="11%">Type</th>
					<th class="kc-test-viewheader" scope="col" width="11%">Country</th>
					<th class="kc-test-viewheader" scope="col" width="11%">Control</th>
					<th class="kc-test-viewheader" scope="col" width="20%">Controllable Unit</th>
					<th class="kc-test-viewheader" scope="col" width="10%">Sample</th>
					<th class="kc-test-viewheader" scope="col" width="7%">Original Target to Close</th>
					<th class="kc-test-viewheader" scope="col" width="7%">Current Target to Close</th>
					<th class="kc-test-viewheader" scope="col" width="5%"># Defects</th>
					<th class="kc-test-viewheader" scope="col" width="13%">Defect Type</th>
				</thead>
				{{#each KC2Test3Data}}
					<tr data-tt-id={{id}} data-tt-parent-id="{{parent}}" class="asmt-viewdata">
						<td width="5%">{{#if catEntry}}{{originalReportingQuarter}}{{/if}}</td>
						<td width="11%">{{#if catEntry}}{{testType}}{{/if}}</td>
						<td width="11%">{{#if catEntry}}{{reportingCountry}}{{/if}}</td>
						<td width="11%">{{#if catEntry}}{{controlName}}{{/if}}</td>
						<td width="20%">{{controllableUnit}}</td>
						<td width="10%"><a target="_blank" href="/asmtcomponents?id={{_id}}&pid={{../parentid}}">{{sampleUniqueID}}</a></td>
						<td width="7%">{{originalTargetDate}}</td>
						<td width="7%">{{targetClose}}</td>
						<td width="5%">{{numDefects}}</td>
						<td width="13%">{{defectType}}</td>
					</tr>
				{{/each}}
			</table>
		</td>
	</tr>
</table>
<script>
	$("#KCT1_treeview").treetable({expandable: true });
	$("#KCT2_treeview").treetable({expandable: true });
	$("#KCT3_treeview").treetable({expandable: true });

	$(document).ready(function() {
	});
</script>
